<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="11/13/2013 1:01:52 PM"
  DTS:CreationName="SSIS.Package.3"
  DTS:CreatorComputerName="DSB075473"
  DTS:CreatorName="DSB\KM2406"
  DTS:DTSID="{0D29B523-D2E9-4A02-B1EA-F56D5764D479}"
  DTS:EnableConfig="True"
  DTS:ExecutableType="SSIS.Package.3"
  DTS:LastModifiedProductVersion="11.0.5583.0"
  DTS:LocaleID="1030"
  DTS:ObjectName="E_edw_dt_FT_Forklaring_ogkuber"
  DTS:PackageType="5"
  DTS:ProtectionLevel="0"
  DTS:VersionBuild="263"
  DTS:VersionGUID="{5C5C78F5-7558-4CC4-AD8F-C4AE9B8DD092}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">6</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[mssqlp01\alpha.DM_Ukurans]"
      DTS:CreationName="MSOLAP100"
      DTS:DTSID="{783b742a-5c41-41a2-9d5d-46d30b127eaf}"
      DTS:ObjectName="mssqlp01\alpha.DM_Ukurans">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=mssqlp01\alpha;Initial Catalog=DM_Ukurans;Provider=MSOLAP.5;Integrated Security=SSPI;Impersonation Level=Impersonate;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{3ECC997C-4E4F-4CB8-AF8C-9FC67A954C1A}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Counter">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{DADF9533-0DEA-44F2-ADA2-8DC01FC22BA5}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DATABASE">
      <DTS:VariableValue
        DTS:DataType="8">Ukurans</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{27C5BAFD-2883-4AA7-BF72-320CDDFF1911}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SERVER">
      <DTS:VariableValue
        DTS:DataType="8">mssqlp01\alpha</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Ajourføring af flag via views"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{FBE2DE04-C039-45B9-8525-8A762D3D4D44}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Ajourføring af flag via views"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="-- Flag ajourføres&#xA;&#xA;Update a&#xA;Set Flg_Uroerte = b.Flg_Uroerte&#xA;From edw.FT_Forklaring a&#xA;Left join dbo.vw_Flg_Uroerte b on a.FraTil_Tid = b.FraTil_Tid and a.Materiale = b.Materiale&#xA;Where a.FraTil_tid = (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'PrimoDato') + '-'  &#xA;+ (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'UltimoDato')&#xA;Go &#xA;&#xA;&#xA;Update a&#xA;Set Flg_NytMat36md = b.Flg_NytMat36md&#xA;From edw.FT_Forklaring a&#xA;Left join dbo.vw_Flg_NytMat36md b on a.FraTil_Tid = b.FraTil_Tid and a.Materiale = b.Materiale&#xA;Where a.FraTil_tid = (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'PrimoDato') + '-'  &#xA;+ (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'UltimoDato')&#xA;Go&#xA;&#xA;Update a&#xA;Set Flg_Indk12md = b.Flg_Indk12md&#xA;From edw.FT_Forklaring a&#xA;Left join dbo.vw_Flg_Indk12md b on a.FraTil_Tid = b.FraTil_Tid and a.Materiale = b.Materiale&#xA;Where a.FraTil_tid = (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'PrimoDato') + '-'  &#xA;+ (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'UltimoDato')&#xA;Go&#xA;&#xA;&#xA;-----------------------------&#xA;-- Fjern flag på urørte, der i ultimoperiode er omløbsvarer. &#xA;&#xA;Update a&#xA;Set a.Flg_Uroerte = 0 &#xA;From edw.FT_Forklaring a&#xA;Left join edw.Dim_Materiale b on a.Materiale = b.Materiale &#xA;&#x9;and b.GyldigFra &lt;= (select top 10 cast(substring(a.FraTil_Tid, 8,4) + '-' + right(a.FraTil_Tid, 2) + '-01' as datetime)) &#xA;&#x9;and b.GyldigTil &gt;  (select top 10 cast(substring(a.FraTil_Tid, 8,4) + '-' + right(a.FraTil_Tid, 2) + '-01' as datetime)) &#xA;Where b.OmlVare is not null&#xA;&#x9;and a.Flg_Uroerte = 1&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Deploy Nedskriv cube"
      DTS:CreationName="Microsoft.DataTransformationServices.Tasks.DTSProcessingTask.DTSProcessingTask, Microsoft.SqlServer.ASTasks, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Analysis Services Processing Task"
      DTS:DTSID="{1837BE64-CEFD-475F-A9FC-ADE2F9B3C64D}"
      DTS:ExecutableType="Microsoft.DataTransformationServices.Tasks.DTSProcessingTask.DTSProcessingTask, Microsoft.SqlServer.ASTasks, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Deploy Nedskriv cube"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <ASProcessingData
          ConnectionName="UkuransKube"
          ProcessingCommands="&lt;Batch xmlns=&quot;http://schemas.microsoft.com/analysisservices/2003/engine&quot;&gt;&#xA;  &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot;&gt;&#xA;    &lt;Object&gt;&#xA;      &lt;DatabaseID&gt;Ukurans&lt;/DatabaseID&gt;&#xA;      &lt;CubeID&gt;Nedskriv&lt;/CubeID&gt;&#xA;    &lt;/Object&gt;&#xA;    &lt;Type&gt;ProcessFull&lt;/Type&gt;&#xA;    &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;  &lt;/Process&gt;&#xA;&lt;/Batch&gt;" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Find laveste Nedskrivningstype og - procent"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{6AD469B7-3BE7-4229-8D9E-43C939FBF044}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Find laveste Nedskrivningstype og - procent"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="-- Find laveste Nedskrivningstype og - procent&#x9;&#xA;Update a&#xA;Set LNType = dbo.minNedSkrPctKolonne(Statusnedskrpct,Langnedskrpct,Raekkenedskrpct,Litranedskrpct)&#xA;,LavNedPct = dbo.minNedSkrPctVaerdi(Statusnedskrpct,Langnedskrpct,Raekkenedskrpct,Litranedskrpct)&#xA;From edw.FT_Nedskriv a&#xA;Where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') + '-' &#xA;&#x9;+(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato')&#xA;&#xA;Go" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Kør Tjek-rapport for FT_Forklaring"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{682EC73C-10C3-4E23-B659-29962810FD9F}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Kør Tjek-rapport for FT_Forklaring"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="&#xA;-- Antal fabrik/materialer indlæst til tabel edw.FT_Forklaring&#xA;Delete from edw.CD_TjekTabeller&#xA;Where&#x9;ProcesNr&#x9;=&#x9;'37a'&#xA;&#x9;and&#x9;Tabel&#x9;&#x9;=&#x9;'edw.FT_Forklaring'&#xA;&#x9;and&#x9;BeregnDato&#x9;=&#x9;(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato')&#x9;&#xA;Insert into edw.CD_TjekTabeller&#xA;Select&#x9;'37a' as ProcesNr&#xA;&#x9;&#x9;,(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato') as BeregnDato&#xA;&#x9;&#x9;,'edw.FT_Forklaring' as Tabel&#xA;&#x9;&#x9;,'Materiale' as Felt &#xA;&#x9;&#x9;,'Antal fabrik/materialer i FT_Forklaring' as Forklaring&#xA;&#x9;&#x9;,(Select  count(Materiale) From edw.FT_Forklaring&#xA;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') + '-' &#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato')&#xA;&#x9;and Dim_Aendring = 'NEDS_NETTO')&#xA;&#xA;-- Antal forskellige materialer indlæst til tabel edw.FT_Forklaring&#xA;Delete from edw.CD_TjekTabeller&#xA;Where&#x9;ProcesNr&#x9;=&#x9;'37b'&#xA;&#x9;and&#x9;Tabel&#x9;&#x9;=&#x9;'edw.FT_Forklaring'&#xA;&#x9;and&#x9;BeregnDato&#x9;=&#x9;(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato')&#x9;&#xA;Insert into edw.CD_TjekTabeller&#xA;Select&#x9;'37b' as ProcesNr&#xA;&#x9;&#x9;,(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato') as BeregnDato&#xA;&#x9;&#x9;,'edw.FT_Forklaring' as Tabel&#xA;&#x9;&#x9;,'Materiale' as Felt &#xA;&#x9;&#x9;,'Antal forskellige materialer i FT_Forklaring' as Forklaring&#xA;&#x9;&#x9;,(Select  count(distinct(Materiale)) From edw.FT_Forklaring&#xA;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') + '-' &#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato')&#xA;&#x9;and Dim_Aendring = 'NEDS_NETTO')&#xA;&#x9;&#x9;&#x9;&#xA;-- Sum af beholdninger i FT_Forklaring indlæst til tabel edw.FT_Forklaring&#xA;Delete from edw.CD_TjekTabeller&#xA;Where&#x9;ProcesNr&#x9;=&#x9;'37c'&#xA;&#x9;and&#x9;Tabel&#x9;&#x9;=&#x9;'edw.FT_Forklaring'&#xA;&#x9;and&#x9;BeregnDato&#x9;=&#x9;(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato')&#x9;&#xA;Insert into edw.CD_TjekTabeller&#xA;Select&#x9;'37c' as ProcesNr&#xA;&#x9;&#x9;,(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato') as BeregnDato&#xA;&#x9;&#x9;,'edw.FT_Forklaring' as Tabel&#xA;&#x9;&#x9;,'Beholdning' as Felt &#xA;&#x9;&#x9;,'Sum af beholdning i FT_Forklaring' as Forklaring&#xA;&#x9;&#x9;,(Select sum(Beholdning) From edw.FT_Forklaring&#xA;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') + '-' &#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato')&#xA;&#x9;and Dim_Aendring = 'NEDS_NETTO')&#xA;&#x9;&#xA;&#x9;&#xA;-- Sum af Vaerdi_SP i FT_Forklaring indlæst til tabel edw.FT_Forklaring&#xA;Delete from edw.CD_TjekTabeller&#xA;Where&#x9;ProcesNr&#x9;=&#x9;'37d'&#xA;&#x9;and&#x9;Tabel&#x9;&#x9;=&#x9;'edw.FT_Forklaring'&#xA;&#x9;and&#x9;BeregnDato&#x9;=&#x9;(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato')&#x9;&#xA;Insert into edw.CD_TjekTabeller&#xA;Select&#x9;'37d' as ProcesNr&#xA;&#x9;&#x9;,(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato') as BeregnDato&#xA;&#x9;&#x9;,'edw.FT_Forklaring' as Tabel&#xA;&#x9;&#x9;,'Vaerdi_SP' as Felt &#xA;&#x9;&#x9;,'Sum af Vaerdi_SP i FT_Forklaring' as Forklaring&#xA;&#x9;&#x9;,(Select sum(Vaerdi_SP) From edw.FT_Forklaring&#xA;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') + '-' &#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato')&#xA;&#x9;and Dim_Aendring = 'NEDS_NETTO')&#xA;&#x9;&#x9;&#x9;&#xA;-- Sum af Vaerdi_GP i FT_Forklaring indlæst til tabel edw.FT_Forklaring&#xA;Delete from edw.CD_TjekTabeller&#xA;Where&#x9;ProcesNr&#x9;=&#x9;'37e'&#xA;&#x9;and&#x9;Tabel&#x9;&#x9;=&#x9;'edw.FT_Forklaring'&#xA;&#x9;and&#x9;BeregnDato&#x9;=&#x9;(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato')&#x9;&#xA;Insert into edw.CD_TjekTabeller&#xA;Select&#x9;'37e' as ProcesNr&#xA;&#x9;&#x9;,(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato') as BeregnDato&#xA;&#x9;&#x9;,'edw.FT_Forklaring' as Tabel&#xA;&#x9;&#x9;,'AnskVaerdi' as Felt &#xA;&#x9;&#x9;,'Sum af AnskVaerdi i FT_Forklaring' as Forklaring&#xA;&#x9;&#x9;,(Select sum(AnskVaerdi) From edw.FT_Forklaring&#xA;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') + '-' &#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato')&#xA;&#x9;and Dim_Aendring = 'NEDS_NETTO')" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Kør Tjek-rapport for FT_Nedskriv"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{E71D95F1-CB4A-471E-8191-5A8C6A2938EE}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Kør Tjek-rapport for FT_Nedskriv"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="&#xA;-- Antal fabrik/materialer indlæst til tabel edw.FT_Nedskriv&#xA;Delete from edw.CD_TjekTabeller&#xA;Where&#x9;ProcesNr&#x9;=&#x9;'36a'&#xA;&#x9;and&#x9;Tabel&#x9;&#x9;=&#x9;'edw.FT_Nedskriv'&#xA;&#x9;and&#x9;BeregnDato&#x9;=&#x9;(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato')&#x9;&#xA;Insert into edw.CD_TjekTabeller&#xA;Select&#x9;'36a' as ProcesNr&#xA;&#x9;&#x9;,(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato') as BeregnDato&#xA;&#x9;&#x9;,'edw.FT_Nedskriv' as Tabel&#xA;&#x9;&#x9;,'Fabrik/Materiale' as Felt &#xA;&#x9;&#x9;,'Antal fabrik/materialer i FT_Nedskriv' as Forklaring&#xA;&#x9;&#x9;,(Select count([Materiale]) from [UKURANS].[edw].[FT_Nedskriv]&#xA;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') + '-' &#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato'))&#xA;&#x9;&#x9;&#x9;&#xA;&#xA;-- Antal forskellige materialer indlæst til tabel edw.FT_Nedskriv&#xA;Delete from edw.CD_TjekTabeller&#xA;Where&#x9;ProcesNr&#x9;=&#x9;'36b'&#xA;&#x9;and&#x9;Tabel&#x9;&#x9;=&#x9;'edw.FT_Nedskriv'&#xA;&#x9;and&#x9;BeregnDato&#x9;=&#x9;(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato')&#x9;&#xA;Insert into edw.CD_TjekTabeller&#xA;Select&#x9;'36b' as ProcesNr&#xA;&#x9;&#x9;,(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato') as BeregnDato&#xA;&#x9;&#x9;,'edw.FT_Nedskriv' as Tabel&#xA;&#x9;&#x9;,'Materiale' as Felt &#xA;&#x9;&#x9;,'Antal forskellige materialer i FT_Nedskriv' as Forklaring&#xA;&#x9;&#x9;,(Select count(distinct(Materiale)) from [UKURANS].[edw].[FT_Nedskriv]&#xA;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') + '-' &#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato'))&#xA;&#x9;&#x9;&#x9;&#xA;-- Sum af beholdninger i FT_Nedskriv indlæst til tabel edw.FT_Nedskriv&#xA;Delete from edw.CD_TjekTabeller&#xA;Where&#x9;ProcesNr&#x9;=&#x9;'36c'&#xA;&#x9;and&#x9;Tabel&#x9;&#x9;=&#x9;'edw.FT_Nedskriv'&#xA;&#x9;and&#x9;BeregnDato&#x9;=&#x9;(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato')&#x9;&#xA;Insert into edw.CD_TjekTabeller&#xA;Select&#x9;'36c' as ProcesNr&#xA;&#x9;&#x9;,(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato') as BeregnDato&#xA;&#x9;&#x9;,'edw.FT_Nedskriv' as Tabel&#xA;&#x9;&#x9;,'Beholdning' as Felt &#xA;&#x9;&#x9;,'Sum af beholdninger i FT_Nedskriv' as Forklaring&#xA;&#x9;&#x9;,(Select sum([Beholdning]) from [UKURANS].[edw].[FT_Nedskriv]&#xA;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') + '-' &#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato'))&#xA;&#xA;-- Sum af Vaerdi_SP i FT_Nedskriv indlæst til tabel edw.FT_Nedskriv&#xA;Delete from edw.CD_TjekTabeller&#xA;Where&#x9;ProcesNr&#x9;=&#x9;'36d'&#xA;&#x9;and&#x9;Tabel&#x9;&#x9;=&#x9;'edw.FT_Nedskriv'&#xA;&#x9;and&#x9;BeregnDato&#x9;=&#x9;(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato')&#x9;&#xA;Insert into edw.CD_TjekTabeller&#xA;Select&#x9;'36d' as ProcesNr&#xA;&#x9;&#x9;,(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato') as BeregnDato&#xA;&#x9;&#x9;,'edw.FT_Nedskriv' as Tabel&#xA;&#x9;&#x9;,'Vaerdi_SP' as Felt &#xA;&#x9;&#x9;,'Sum af Vaerdi_SP i FT_Nedskriv' as Forklaring&#xA;&#x9;&#x9;,(Select sum([Vaerdi_SP]) from [UKURANS].[edw].[FT_Nedskriv]&#xA;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') + '-' &#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato'))&#xA;&#x9;&#x9;&#x9;&#xA;-- Sum af Vaerdi_GP i FT_Nedskriv indlæst til tabel edw.FT_Nedskriv&#xA;Delete from edw.CD_TjekTabeller&#xA;Where&#x9;ProcesNr&#x9;=&#x9;'36e'&#xA;&#x9;and&#x9;Tabel&#x9;&#x9;=&#x9;'edw.FT_Nedskriv'&#xA;&#x9;and&#x9;BeregnDato&#x9;=&#x9;(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato')&#x9;&#xA;Insert into edw.CD_TjekTabeller&#xA;Select&#x9;'36e' as ProcesNr&#xA;&#x9;&#x9;,(select cast(left(vaerdi, 8) + '01' as datetime) from edw.md_styringstabel where parameter = 'RegnOpdtDato') as BeregnDato&#xA;&#x9;&#x9;,'edw.FT_Nedskriv' as Tabel&#xA;&#x9;&#x9;,'Vaerdi_GP' as Felt &#xA;&#x9;&#x9;,'Sum af Vaerdi_GP i FT_Nedskriv' as Forklaring&#xA;&#x9;&#x9;,(Select sum([Vaerdi_GP]) from [UKURANS].[edw].[FT_Nedskriv]&#xA;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') + '-' &#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato'))" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Opdater nøgletal"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{A82E6268-858A-47B0-899D-EC78A8CB048D}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Opdater nøgletal"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="-----------&#xA;&#xA;-- Opdater nøgletal i edw.FT_NoegleTal&#xA;  &#xA;-----------&#xA;&#xA;Delete from edw.FT_NoegleTal&#xA;Where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;  and Rap_Dim = 'LitraGr'&#xA;Insert into edw.FT_NoegleTal&#xA;Select 'LitraGr' as Rap_Dim&#xA;,(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato') as Dim_Tid&#xA;,b.LitraGr2 as Dim_Vaerdi&#xA;,sum(Vaerdi_GP) as AnskVaerdi&#xA;,sum(LogNedBrutto)*-1 as LogNedBrutto&#xA;,sum(NedskrNetto) *-1 as NedskrNetto&#xA;,sum(LogNedBrutto)/sum(Vaerdi_GP) *-1 as LogNedPct&#xA;,sum(NedskrNetto)/sum(Vaerdi_GP) *-1 as NetNedPct&#xA;,avg(DUF) /365.0 as AvgDUF&#xA;,avg(RID) /365.0 as AvgRID&#xA;,sum(LogNedBrutto)/(Select sum(LogNedBrutto) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato'))&#xA;&#x9;as PctAfBrutto&#xA;,sum(NedskrNetto)/(Select sum(NedskrNetto) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')) &#xA;&#x9;as PctAfNetto&#xA;,Case when b.LitraGr2 is null&#x9;then (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (RID &lt; 365 or RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (DUF &lt; 365 or DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else Max(c.AnskVaerdi) end as HoejOmsHast&#xA;,Case when b.LitraGr2 is null&#x9;then (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (RID &lt; 365 or RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (DUF &lt; 365 or DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;/&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else Max(c.AnskVaerdi)/Max(d.AnskVaerdi) end as PctHOmstHast&#xA;,Cast((select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') &#xA;&#x9;+ '-' +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato') &#xA;&#x9;as Varchar (13)) as FraTil_tid&#xA;From edw.FT_Nedskriv a&#xA;Left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#xA;Left join (Select g.LitraGr2, sum(f.Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv f&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Left join edw.Dim_Materiale g on f.Dim_Materiale = g.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (f.RID &lt; 365 or f.RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (f.DUF &lt; 365 or f.DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Group by g.LitraGr2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;With rollup&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;) c &#xA;&#x9;on b.LitraGr2 = c.LitraGr2&#xA;&#xA;Left join (Select i.LitraGr2, sum(h.Vaerdi_GP) anskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv h&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Left join edw.Dim_Materiale i on h.Dim_Materiale = i.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Group by i.LitraGr2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;With rollup&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;) d &#xA;&#x9;on b.LitraGr2 = d.LitraGr2&#xA;&#xA;&#xA;Where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;and Beholdning &gt; 0&#xA;Group by b.LitraGr2&#xA;With Rollup&#xA;Order by sum(Vaerdi_GP) desc&#xA;Go&#xA;-------------------------&#xA;Delete from edw.FT_NoegleTal&#xA;Where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;  and Rap_Dim = 'Fabrik'&#xA;Insert into edw.FT_NoegleTal&#xA;Select 'Fabrik' as Rap_Dim&#xA;,(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato') as Dim_Tid&#xA;,a.Dim_Fabrik as Dim_Vaerdi&#xA;,sum(Vaerdi_GP) as AnskVaerdi&#xA;,sum(LogNedBrutto) *-1 as LogNedBrutto&#xA;,sum(NedskrNetto) *-1 as NedskrNetto&#xA;,sum(LogNedBrutto)/sum(Vaerdi_GP) *-1 as LogNedPct&#xA;,sum(NedskrNetto)/sum(Vaerdi_GP) *-1 as NetNedPct&#xA;,avg(DUF) /365.0 as AvgDUF&#xA;,avg(RID) /365.0 as AvgRID&#xA;,sum(LogNedBrutto)/(Select sum(LogNedBrutto) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato'))&#xA;&#x9;as PctAfBrutto&#xA;,sum(NedskrNetto)/(Select sum(NedskrNetto) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato'))&#xA;&#x9;as PctAfNetto&#xA;,Case when a.Dim_Fabrik is null&#x9;then (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (RID &lt; 365 or RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (DUF &lt; 365 or DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else Max(c.AnskVaerdi) end as HoejOmsHast&#xA;,Case when a.Dim_Fabrik is null&#x9;then (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (RID &lt; 365 or RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (DUF &lt; 365 or DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;/&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else Max(c.AnskVaerdi)/Max(d.AnskVaerdi) end as PctHOmstHast&#xA;,Cast((select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') &#xA;&#x9;+ '-' +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato') &#xA;&#x9;as Varchar (13)) as FraTil_tid&#xA;From edw.FT_Nedskriv a&#xA;Left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#xA;Left join (Select f.Dim_Fabrik, sum(f.Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv f&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Left join edw.Dim_Materiale g on f.Dim_Materiale = g.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (f.RID &lt; 365 or f.RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (f.DUF &lt; 365 or f.DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Group by f.Dim_Fabrik&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;With rollup&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;) c &#xA;&#x9;on a.Dim_Fabrik = c.Dim_Fabrik&#xA;&#xA;Left join (Select h.Dim_Fabrik, sum(h.Vaerdi_GP) anskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv h&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Left join edw.Dim_Materiale i on h.Dim_Materiale = i.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Group by h.Dim_Fabrik&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;With rollup&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;) d &#xA;&#x9;on a.Dim_Fabrik = d.Dim_Fabrik&#xA;&#xA;&#xA;Where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;and Beholdning &gt; 0&#xA;Group by a.Dim_Fabrik&#xA;With Rollup&#xA;Order by a.Dim_Fabrik&#xA;Go&#xA;----------------------------&#xA;Delete from edw.FT_NoegleTal&#xA;Where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;  and Rap_Dim = 'LNType'&#xA;Insert into edw.FT_NoegleTal&#xA;Select 'LNType' as Rap_Dim&#xA;,(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato') as Dim_Tid&#xA;,a.LNType as Dim_Vaerdi&#xA;,sum(Vaerdi_GP) as AnskVaerdi&#xA;,sum(LogNedBrutto) *-1 as LogNedBrutto&#xA;,sum(NedskrNetto) *-1 as NedskrNetto&#xA;,sum(LogNedBrutto)/sum(Vaerdi_GP) *-1 as LogNedPct&#xA;,sum(NedskrNetto)/sum(Vaerdi_GP) *-1 as NetNedPct&#xA;,avg(DUF) /365.0 as AvgDUF&#xA;,avg(RID) /365.0 as AvgRID&#xA;,sum(LogNedBrutto)/(Select sum(LogNedBrutto) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato'))&#xA;&#x9;as PctAfBrutto&#xA;,sum(NedskrNetto)/(Select sum(NedskrNetto) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato'))&#xA;&#x9;as PctAfNetto&#xA;,Case when a.LNType is null&#x9;then (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (RID &lt; 365 or RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (DUF &lt; 365 or DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else Max(c.AnskVaerdi) end as HoejOmsHast&#xA;,Case when a.LNType is null&#x9;then (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (RID &lt; 365 or RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (DUF &lt; 365 or DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;/&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else Max(c.AnskVaerdi)/Max(d.AnskVaerdi) end as PctHOmstHast&#xA;,Cast((select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') &#xA;&#x9;+ '-' +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato') &#xA;&#x9;as Varchar (13)) as FraTil_tid&#xA;From edw.FT_Nedskriv a&#xA;Left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#xA;Left join (Select f.LNType, sum(f.Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv f&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Left join edw.Dim_Materiale g on f.Dim_Materiale = g.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (f.RID &lt; 365 or f.RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (f.DUF &lt; 365 or f.DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Group by f.LNType&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;With rollup&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;) c &#xA;&#x9;on a.LNType = c.LNType&#xA;&#xA;Left join (Select h.LNType, sum(h.Vaerdi_GP) anskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv h&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Left join edw.Dim_Materiale i on h.Dim_Materiale = i.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Group by h.LNType&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;With rollup&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;) d &#xA;&#x9;on a.LNType = d.LNType&#xA;&#xA;&#xA;Where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;and Beholdning &gt; 0&#xA;Group by a.LNType&#xA;With Rollup&#xA;Order by a.LNType&#xA;Go&#xA;---------------------&#xA;Delete from edw.FT_NoegleTal&#xA;Where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;  and Rap_Dim = 'StatusGr'&#xA;Insert into edw.FT_NoegleTal&#xA;Select 'StatusGr' as Rap_Dim&#xA;,(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato') as Dim_Tid&#xA;,b.StatusGr2 as Dim_Vaerdi&#xA;,sum(Vaerdi_GP) as AnskVaerdi&#xA;,sum(LogNedBrutto) *-1 as LogNedBrutto&#xA;,sum(NedskrNetto) *-1 as NedskrNetto&#xA;,sum(LogNedBrutto)/sum(Vaerdi_GP) *-1 as LogNedPct&#xA;,sum(NedskrNetto)/sum(Vaerdi_GP) *-1 as NetNedPct&#xA;,avg(DUF) /365.0 as AvgDUF&#xA;,avg(RID) /365.0 as AvgRID&#xA;,sum(LogNedBrutto)/(Select sum(LogNedBrutto) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato'))&#xA;&#x9;as PctAfBrutto&#xA;,sum(NedskrNetto)/(Select sum(NedskrNetto) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato'))&#xA;&#x9;as PctAfNetto&#xA;,Case when b.StatusGr2 is null&#x9;then (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (RID &lt; 365 or RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (DUF &lt; 365 or DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else Max(c.AnskVaerdi) end as HoejOmsHast&#xA;,Case when b.StatusGr2 is null&#x9;then (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (RID &lt; 365 or RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (DUF &lt; 365 or DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;/&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else Max(c.AnskVaerdi)/Max(d.AnskVaerdi) end as PctHOmstHast&#xA;,Cast((select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') &#xA;&#x9;+ '-' +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato') &#xA;&#x9;as Varchar (13)) as FraTil_tid&#xA;From edw.FT_Nedskriv a&#xA;Left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#xA;Left join (Select g.StatusGr2, sum(f.Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv f&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Left join edw.Dim_Materiale g on f.Dim_Materiale = g.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (f.RID &lt; 365 or f.RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (f.DUF &lt; 365 or f.DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Group by g.StatusGr2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;With rollup&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;) c &#xA;&#x9;on b.StatusGr2 = c.StatusGr2&#xA;&#xA;Left join (Select i.StatusGr2, sum(h.Vaerdi_GP) anskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv h&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Left join edw.Dim_Materiale i on h.Dim_Materiale = i.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Group by i.StatusGr2&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;With rollup&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;) d &#xA;&#x9;on b.StatusGr2 = d.StatusGr2&#xA;&#xA;&#xA;Where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;and Beholdning &gt; 0&#xA;Group by b.StatusGr2&#xA;With Rollup&#xA;Order by sum(Vaerdi_GP) desc&#xA;Go&#xA;----------------------------&#xA;Delete from edw.FT_NoegleTal&#xA;Where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;  and Rap_Dim = 'FLNType'&#xA;Insert into edw.FT_NoegleTal&#xA;Select 'FLNType' as Rap_Dim&#xA;,(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato') as Dim_Tid&#xA;,a.FLNType as Dim_Vaerdi&#xA;,sum(Vaerdi_GP) as AnskVaerdi&#xA;,sum(LogNedBrutto) *-1 as LogNedBrutto&#xA;,sum(NedskrNetto) *-1 as NedskrNetto&#xA;,sum(LogNedBrutto)/sum(Vaerdi_GP) *-1 as LogNedPct&#xA;,sum(NedskrNetto)/sum(Vaerdi_GP) *-1 as NetNedPct&#xA;,avg(DUF) /365.0 as AvgDUF&#xA;,avg(RID) /365.0 as AvgRID&#xA;,sum(LogNedBrutto)/(Select sum(LogNedBrutto) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato'))&#xA;&#x9;as PctAfBrutto&#xA;,sum(NedskrNetto)/(Select sum(NedskrNetto) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato'))&#xA;&#x9;as PctAfNetto&#xA;,Case when a.FLNType is null&#x9;then (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (RID &lt; 365 or RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (DUF &lt; 365 or DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else Max(c.AnskVaerdi) end as HoejOmsHast&#xA;,Case when a.FLNType is null&#x9;then (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (RID &lt; 365 or RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (DUF &lt; 365 or DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;/&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;  (Select sum(Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) &#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;else Max(c.AnskVaerdi)/Max(d.AnskVaerdi) end as PctHOmstHast&#xA;,Cast((select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') &#xA;&#x9;+ '-' +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato') &#xA;&#x9;as Varchar (13)) as FraTil_tid&#xA;From edw.FT_Nedskriv a&#xA;Left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#xA;Left join (Select f.FLNType, sum(f.Vaerdi_GP) as AnskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv f&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Left join edw.Dim_Materiale g on f.Dim_Materiale = g.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (f.RID &lt; 365 or f.RID is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (f.DUF &lt; 365 or f.DUF is null)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Group by f.FLNType&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;With rollup&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;) c &#xA;&#x9;on a.FLNType = c.FLNType&#xA;&#xA;Left join (Select h.FLNType, sum(h.Vaerdi_GP) anskVaerdi&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv h&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Left join edw.Dim_Materiale i on h.Dim_Materiale = i.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;Group by h.FLNType&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;With rollup&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;) d &#xA;&#x9;on a.FLNType = d.FLNType&#xA;&#xA;&#xA;Where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;and Beholdning &gt; 0&#xA;Group by a.FLNType&#xA;With Rollup&#xA;Order by a.FLNType&#xA;Go&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Overfør data fra  view vedrørende reelle ekstra-nedskrivninger"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{B22BCD99-85B6-4ACA-B5AF-46A823AC5949}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Overfør data fra  view vedrørende reelle ekstra-nedskrivninger"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="-- Slet eksisterende data&#xA;&#xA;Delete from edw.FT_Forklaring&#xA;Where FraTil_tid = (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'PrimoDato') + '-'  &#xA;+ (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'UltimoDato')&#xA;&#x9;and&#x9;Dim_Aendring in ('STATUS_REELT_BR' , 'STATUS_REELT_NT' , 'LITRANEDSKR_REELT')&#xA;&#xA;Go&#xA;&#xA;&#xA;-- Overfør data fra view&#xA;&#xA;Insert into edw.FT_Forklaring&#xA;Select *&#xA;,0 as Flg_Uroerte&#xA;,0 as Flg_NytMat36md&#xA;,0 as Flg_Indk12md&#xA;,0 as Dim_Fabrik_Materiale &#xA;From dbo.vw_Reelle_Ekstra_Nedskr&#xA;Where FraTil_tid = (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'PrimoDato') + '-'  &#xA;+ (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'UltimoDato')&#xA;&#xA;Go" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Overfør data fra view FT_Forklaring til FT_Forklaring tabel"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{a1a53a31-b53a-49db-9c62-6cb7ec4bf96b}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Overfør data fra view FT_Forklaring til FT_Forklaring tabel"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="-- Overfør data til Forklaringskube&#xA;&#xA;Delete from edw.FT_Forklaring&#xA;Where FraTil_tid = (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'PrimoDato') + '-'  &#xA;+ (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'UltimoDato')&#xA;Go&#xA;&#xA;Insert into edw.FT_Forklaring&#xA;Select * &#xA;,0 as Flg_Uroerte&#xA;,0 as Flg_NytMat36md&#xA;,0 as Flg_Indk12md&#xA;,0 as Dim_Fabrik_Materiale &#xA;From dbo.vw_Forklaring_1del &#xA;&#xA;Go&#xA;&#xA;Insert into edw.FT_Forklaring&#xA;Select * &#xA;,0 as Flg_Uroerte&#xA;,0 as Flg_NytMat36md&#xA;,0 as Flg_Indk12md&#xA;,0 as Dim_Fabrik_Materiale &#xA;From dbo.vw_Forklaring_2del &#xA;&#xA;Go&#xA;&#xA;insert into edw.FT_Forklaring&#xA;select 'AFSTEMNING1' Aendring,  Dim_Fabrik, Materiale, Dim_Materiale, LNType, FLNType, FraTil_tid, AnskVaerdi, NedForPrinc, &#xA;&#x9;Case&#x9;When&#x9;NedskrNetto &lt;&gt; 0 &#xA;&#x9;&#x9;&#x9;Then&#x9;Case&#x9;When&#x9;NedForPrinc&#x9;&lt;&gt;&#x9;0 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Then&#x9;NedskrNetto&#x9;-&#x9;NedForPrinc&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Else&#x9;NedskrNetto&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End&#xA;&#x9;&#x9;&#x9;Else&#x9;Case&#x9;When&#x9;NedForPrinc&#x9;&lt;&gt;&#x9;0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Then&#x9;NedForPrinc * -1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Else&#x9;0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End&#xA;&#x9;End DSystAendr,&#xA;NedskrNetto, Beholdning, Vaerdi_SP, Isnull(AnskVaerdi, 0) - Isnull(Vaerdi_SP, 0) as Forskel&#xA;,0 as Flg_Uroerte&#xA;,0 as Flg_NytMat36md&#xA;,0 as Flg_Indk12md&#xA;,0 as Dim_Fabrik_Materiale&#xA;From [dbo].[vw_Afstemning]&#xA;&#xA;Go" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Overfør data fra views vedrørende delta-summer"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{B22E6F7C-6FEB-45A0-B0A5-83BF15AA0ECC}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Overfør data fra views vedrørende delta-summer"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="&#xA;-- Slet eksisterende data&#xA;&#xA;Delete from edw.FT_Forklaring&#xA;Where FraTil_tid = (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'PrimoDato') + '-'  &#xA;+ (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'UltimoDato')&#xA;&#x9;and&#x9;Dim_Aendring in ('DELTA_BRUTTO' , 'DELTA_NETTO')&#xA;&#xA;Go&#xA;&#xA;&#xA;-- Overfør data fra views&#xA;&#xA;Insert into edw.FT_Forklaring&#xA;Select *&#xA;,0 as Flg_Uroerte&#xA;,0 as Flg_NytMat36md&#xA;,0 as Flg_Indk12md&#xA;,0 as Dim_Fabrik_Materiale &#xA;From dbo.vw_Delta_Brutto &#xA;Where FraTil_tid = (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'PrimoDato') + '-'  &#xA;+ (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'UltimoDato')&#xA;&#xA;Go&#xA;&#xA;Insert into edw.FT_Forklaring&#xA;Select *&#xA;,0 as Flg_Uroerte&#xA;,0 as Flg_NytMat36md&#xA;,0 as Flg_Indk12md&#xA;,0 as Dim_Fabrik_Materiale &#xA;From dbo.vw_Delta_Netto &#xA;Where FraTil_tid = (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'PrimoDato') + '-'  &#xA;+ (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'UltimoDato')&#xA;&#xA;&#xA;Go" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Overfør data til FT_Nedskriv"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{fa83a462-1ba1-4d88-9bba-f54603e55775}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Overfør data til FT_Nedskriv"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="-- Slet data, der opdateres&#xA;&#xA;Delete from edw.FT_Nedskriv&#xA;Where FraTil_tid = (select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'PrimoDato') &#xA;&#x9;+ '-' + ( select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'UltimoDato')&#xA;GO&#xA;&#xA;-- overføre data fra vw til ft_Nedskriv&#xA;&#xA;Insert into edw.FT_Nedskriv&#xA;Select [dim_fabrik]&#xA;      ,[dim_materiale]&#xA;      ,[materiale]&#xA;      ,( select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'UltimoDato')&#xA;      ,[Beholdning]&#xA;      ,[Vaerdi_GP]&#xA;      ,[GlidGnsPris]&#xA;      ,[LNType]&#xA;      ,[FLNType]&#xA;      ,[LavNedPct]&#xA;      ,[LogNedBrutto]&#xA;      ,[LogNedBruttoPae]&#xA;      ,[NedskrNetto]&#xA;      ,[NedKorrNytMat]&#xA;      ,[NedKorrNytMatPae]&#xA;      ,[BrutIndk12mdMgd]&#xA;      ,[StatusNedskrPct]&#xA;      ,[LangNedskrPct]&#xA;      ,[RaekkeNedskrPct]&#xA;      ,[LitraNedskrPct]&#xA;      ,[NedKorrIndk]&#xA;      ,[NedKorrIndkPae]&#xA;      ,[UltBehIndk12mdMgd]&#xA;      ,[UltBehIndk12mdVd]&#xA;      ,[Vaerdi_SP]&#xA;      ,[Forskel]&#xA;      ,[LitraNedVaerdi]&#xA;      ,[DUF]&#xA;      ,[LangNedVaerdi]&#xA;      ,[RID]&#xA;      ,[RaekkeNedVaerdi]&#xA;      ,[StatNedVaerdi]&#xA;      ,[StatNedReelt]&#xA;      ,[RestAabnBalBeh]&#xA;      ,[AabnNedPct]&#xA;      ,[AabnBalNedVaerdi]&#xA;      ,( select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'PrimoDato')&#xA;&#x9;+ '-' + ( select replace(left(vaerdi, 7), '-', '') from edw.md_styringstabel where parameter = 'UltimoDato')&#xA;      ,[NedskrNettoPae]&#xA;From [dbo].[vw_Nedskriv]&#xA;&#xA;GO&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Overfør data vedr urørte beholdninger"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{438CB9B5-BD1E-44EE-A77D-346836FEE216}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Overfør data vedr urørte beholdninger"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="-- Indsæt data for urørte beholdninger som Dim_Aendring (sættes også efterfølgende som flag)&#xA;-- Ajourført 150401-1: Indsat between-parameter, da gamle regnskaber skal kunne efterberegnes.&#xA;&#xA;Delete from edw.FT_Forklaring&#xA;Where Dim_Aendring = 'UROERTE_BR_ULT'&#xA;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') &#xA;&#x9;&#x9;+ '-' +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato')&#xA;&#xA;Go &#xA;&#xA;Insert into edw.FT_Forklaring&#xA;Select 'UROERTE_BR_ULT' as Dim_Aendring, Dim_Fabrik, Materiale, Dim_Materiale, LNType, FLNType, FraTil_tid, AnskVaerdi, NedForPrinc, &#xA;&#x9;Case&#x9;When&#x9;NedskrNetto &lt;&gt; 0 &#xA;&#x9;&#x9;&#x9;Then&#x9;Case&#x9;When&#x9;NedForPrinc&#x9;&lt;&gt;&#x9;0 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Then&#x9;NedskrNetto&#x9;-&#x9;NedForPrinc&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Else&#x9;NedskrNetto&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End&#xA;&#x9;&#x9;&#x9;Else&#x9;Case&#x9;When&#x9;NedForPrinc&#x9;&lt;&gt;&#x9;0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Then&#x9;NedForPrinc * -1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Else&#x9;0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End&#xA;&#x9;End DSystAendr&#xA;&#x9;, NedskrNetto&#xA;&#x9;, Beholdning, Vaerdi_SP, Isnull(AnskVaerdi, 0) - Isnull(Vaerdi_SP, 0) as Forskel&#xA;,0 as Flg_Uroerte&#xA;,0 as Flg_NytMat36md&#xA;,0 as Flg_Indk12md &#xA;,0 as Dim_Fabrik_Materiale&#xA;From dbo.vw_LogNedsBrutto&#xA;Where Materiale not in ((Select distinct Materiale from edw.FT_Transaktioner where RegistrDato &#xA;Between (Select Vaerdi from edw.MD_Styringstabel where Parameter = 'PrimoDato')&#xA;&#x9;and (Select Vaerdi from edw.MD_Styringstabel where Parameter = 'UltimoDato')))&#xA;-- &gt; (Select Vaerdi from edw.MD_Styringstabel where Parameter = 'PrimoDato')))&#xA;&#xA;Go&#xA;------------------------------&#xA;&#xA;Delete from edw.FT_Forklaring&#xA;Where Dim_Aendring = 'UROERTE_BR_PR'&#xA;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') &#xA;&#x9;&#x9;+ '-' +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato')&#xA;&#xA;Insert into edw.FT_Forklaring&#xA;Select 'UROERTE_BR_PR' as Dim_Aendring, Dim_Fabrik, Materiale, Dim_Materiale, LNType, FLNType, FraTil_tid, AnskVaerdi, NedForPrinc, &#xA;&#x9;Case&#x9;When&#x9;NedskrNetto &lt;&gt; 0 &#xA;&#x9;&#x9;&#x9;Then&#x9;Case&#x9;When&#x9;NedForPrinc&#x9;&lt;&gt;&#x9;0 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Then&#x9;NedskrNetto&#x9;-&#x9;NedForPrinc&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Else&#x9;NedskrNetto&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End&#xA;&#x9;&#x9;&#x9;Else&#x9;Case&#x9;When&#x9;NedForPrinc&#x9;&lt;&gt;&#x9;0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Then&#x9;NedForPrinc * -1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Else&#x9;0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End&#xA;&#x9;End DSystAendr&#xA;&#x9;, NedskrNetto&#xA;&#x9;, Beholdning, Vaerdi_SP, Isnull(AnskVaerdi, 0) - Isnull(Vaerdi_SP, 0) as Forskel&#xA;,0 as Flg_Uroerte&#xA;,0 as Flg_NytMat36md&#xA;,0 as Flg_Indk12md &#xA;,0 as Dim_Fabrik_Materiale&#xA;From dbo.vw_Nedskriv_Primo_Brutto&#xA;Where Materiale not in ((Select distinct Materiale from edw.FT_Transaktioner where RegistrDato &#xA;Between (Select Vaerdi from edw.MD_Styringstabel where Parameter = 'PrimoDato')&#xA;&#x9;and (Select Vaerdi from edw.MD_Styringstabel where Parameter = 'UltimoDato')))&#xA;-- &gt; (Select Vaerdi from edw.MD_Styringstabel where Parameter = 'PrimoDato')))&#xA;&#xA;&#xA;Go &#xA;&#xA;-----------------------------------------&#xA;&#xA;Delete from edw.FT_Forklaring&#xA;Where Dim_Aendring = 'UROERTE_NT_ULT'&#xA;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from edw.MD_Styringstabel where parameter = 'PrimoDato') &#xA;&#x9;&#x9;+ '-' +(select replace(left(Vaerdi, 7), '-', '') from edw.MD_Styringstabel where parameter = 'UltimoDato')&#xA;&#xA;Go &#xA;&#xA;Insert into edw.FT_Forklaring&#xA;Select 'UROERTE_NT_ULT' as Dim_Aendring&#xA;      ,Dim_Fabrik&#xA;      ,Materiale&#xA;      ,Dim_Materiale&#xA;      ,LNType&#xA;      ,FLNType&#xA;      ,FraTil_tid&#xA;      ,AnskVaerdi&#xA;      ,NedForPrinc&#xA;      ,DSystAnedr&#xA;      ,NedskrNetto&#xA;      ,Beholdning&#xA;      ,Vaerdi_SP&#xA;      ,Forskel&#xA;,0 as Flg_Uroerte&#xA;,0 as Flg_NytMat36md&#xA;,0 as Flg_Indk12md&#xA;,0 as Dim_Fabrik_Materiale&#xA;From edw.FT_Forklaring&#xA;Where Dim_Aendring = 'NEDS_NETTO'&#xA;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from edw.MD_Styringstabel where parameter = 'PrimoDato') &#xA;&#x9;&#x9;+ '-' +(select replace(left(Vaerdi, 7), '-', '') from edw.MD_Styringstabel where parameter = 'UltimoDato')&#xA;&#xA;Go &#xA;&#xA;Delete from edw.FT_Forklaring&#xA;Where Dim_Aendring = 'UROERTE_NT_ULT'&#xA;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from edw.MD_Styringstabel where parameter = 'PrimoDato') &#xA;&#x9;&#x9;+ '-' +(select replace(left(Vaerdi, 7), '-', '') from edw.MD_Styringstabel where parameter = 'UltimoDato')&#xA;&#x9;and Materiale in ((Select distinct Materiale from edw.FT_Transaktioner where RegistrDato &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Between (Select Vaerdi from edw.MD_Styringstabel where Parameter = 'PrimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (Select Vaerdi from edw.MD_Styringstabel where Parameter = 'UltimoDato')))&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;-- &gt; (Select Vaerdi from edw.MD_Styringstabel where Parameter = 'PrimoDato')))&#x9;&#xA;&#xA;&#xA;Go &#xA;&#x9;&#x9;&#x9;&#x9;  &#xA;---------------------------&#xA;&#xA;Delete from edw.FT_Forklaring&#xA;Where Dim_Aendring = 'UROERTE_NT_PR'&#xA;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') &#xA;&#x9;&#x9;+ '-' +(select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato')&#xA;&#xA;Go &#xA;&#xA;Insert into edw.FT_Forklaring&#xA;Select 'UROERTE_NT_PR' as Dim_Aendring, Dim_Fabrik, Materiale, Dim_Materiale, LNType,  FLNType, FraTil_tid, AnskVaerdi, NedForPrinc&#xA;&#x9;,Case&#x9;When&#x9;NedskrNetto &lt;&gt; 0 &#xA;&#x9;&#x9;&#x9;Then&#x9;Case&#x9;When&#x9;NedForPrinc&#x9;&lt;&gt;&#x9;0 &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Then&#x9;NedskrNetto&#x9;-&#x9;NedForPrinc&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Else&#x9;NedskrNetto&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End&#xA;&#x9;&#x9;&#x9;Else&#x9;Case&#x9;When&#x9;NedForPrinc&#x9;&lt;&gt;&#x9;0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Then&#x9;NedForPrinc * -1&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Else&#x9;0&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;End&#xA;&#x9;End DSystAendr&#xA;&#x9;, NedskrNetto NedskrNetto&#xA;&#x9;,Beholdning, Vaerdi_SP, Isnull(AnskVaerdi, 0) - Isnull(Vaerdi_SP, 0) as Forskel&#xA;,0 as Flg_Uroerte&#xA;,0 as Flg_NytMat36md&#xA;,0 as Flg_Indk12md&#xA;,0 as Dim_Fabrik_Materiale&#xA;From dbo.vw_Nedskriv_Primo_Netto&#xA;Where Materiale not in ((Select distinct Materiale from edw.FT_Transaktioner where RegistrDato &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Between (Select Vaerdi from edw.MD_Styringstabel where Parameter = 'PrimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and (Select Vaerdi from edw.MD_Styringstabel where Parameter = 'UltimoDato')))&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;-- &gt; (Select Vaerdi from edw.MD_Styringstabel where Parameter = 'PrimoDato')))&#x9;&#xA;Go &#xA;&#xA;&#xA;-------------------------&#xA;-- Slet primo urørte beholdninger hvis de er ændret til omløbsvarer&#xA;&#xA;Delete from edw.FT_Forklaring &#xA;Where Dim_Aendring in (&#x9;Select a.Dim_Aendring&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;From edw.FT_Forklaring a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Left join edw.Dim_Materiale b on a.Materiale = b.Materiale &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.GyldigFra &lt;= (select top 10 cast(substring(a.FraTil_Tid, 8,4) + '-' + right(a.FraTil_Tid, 2) + '-01' as datetime)) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.GyldigTil &gt;  (select top 10 cast(substring(a.FraTil_Tid, 8,4) + '-' + right(a.FraTil_Tid, 2) + '-01' as datetime)) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Where a.Dim_Aendring in ('UROERTE_NT_PR' , 'UROERTE_BR_PR')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.OmlVare is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;   )&#xA;&#x9;&#xA;&#x9;and&#x9;Materiale in  ( Select a.Materiale&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;From edw.FT_Forklaring a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Left join edw.Dim_Materiale b on a.Materiale = b.Materiale &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.GyldigFra &lt;= (select top 10 cast(substring(a.FraTil_Tid, 8,4) + '-' + right(a.FraTil_Tid, 2) + '-01' as datetime)) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.GyldigTil &gt;  (select top 10 cast(substring(a.FraTil_Tid, 8,4) + '-' + right(a.FraTil_Tid, 2) + '-01' as datetime)) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Where a.Dim_Aendring in ('UROERTE_NT_PR' , 'UROERTE_BR_PR')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.OmlVare is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;   )&#xA;&#x9;&#xA;&#x9;and&#x9;FraTil_Tid in ( Select a.FraTil_Tid&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;From edw.FT_Forklaring a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Left join edw.Dim_Materiale b on a.Materiale = b.Materiale &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.GyldigFra &lt;= (select top 10 cast(substring(a.FraTil_Tid, 8,4) + '-' + right(a.FraTil_Tid, 2) + '-01' as datetime)) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.GyldigTil &gt;  (select top 10 cast(substring(a.FraTil_Tid, 8,4) + '-' + right(a.FraTil_Tid, 2) + '-01' as datetime)) &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;Where a.Dim_Aendring in ('UROERTE_NT_PR' , 'UROERTE_BR_PR')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.OmlVare is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;   )&#x9;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Påsæt 'AEPD' hvis beholdning sidst var 0"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{A4A55DC3-9B65-4E74-B422-0E0D5AE7FBE6}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Påsæt 'AEPD' hvis beholdning sidst var 0"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="-- Påsæt 'AEPD' hvis beholdning sidst var 0&#xA;Update a&#xA;Set FLNType = 'AEPD'&#xA;From edw.FT_Nedskriv a&#xA;Left join Ukurans.edw.FT_Nedskriv b &#xA;&#x9;on a.Dim_Fabrik = b.Dim_Fabrik and a.Materiale = b.Materiale &#xA;&#x9;&#x9;and a.FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] where parameter = 'PrimoPrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] where parameter = 'PrimoDato')&#xA;Where a.FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;from [edw].[MD_Styringstabel] where parameter = 'UltimoDato')&#xA;--&#x9;and a.FLNType is null&#xA;&#x9;and b.Beholdning is null&#xA;&#xA;Go" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Påsæt FLNType"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{629E909D-E8C1-453E-A290-3092DF6A3E44}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Påsæt FLNType"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="&#xA;-- Påsæt FLNType&#xA;Update a&#xA;Set FLNType = q1.Ny_LNType&#xA;From edw.FT_Nedskriv a&#xA;Left join (select Dim_Fabrik, Materiale, dbo.minNedSkrPctKolonne(Statusnedskrpct,Langnedskrpct,Raekkenedskrpct,Litranedskrpct) as Ny_LNType&#xA;&#x9;&#x9;&#x9;From edw.FT_Nedskriv &#xA;&#x9;&#x9;&#x9;Where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] where parameter = 'PrimoPrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;   &#x9; +(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] where parameter = 'PrimoDato')) q1 &#xA;&#x9;&#x9;&#x9;on a.Dim_Fabrik = q1.Dim_Fabrik and a.Materiale = q1.Materiale&#xA;Where FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;from [edw].[MD_Styringstabel] where parameter = 'UltimoDato')&#xA;&#x9;and FLNType &lt;&gt; q1.Ny_LNType&#xA;&#x9;&#xA;Go" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Redeploy dims for Forklaring cube"
      DTS:CreationName="Microsoft.DataTransformationServices.Tasks.DTSProcessingTask.DTSProcessingTask, Microsoft.SqlServer.ASTasks, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Analysis Services Processing Task"
      DTS:DTSID="{C1B63835-AEA9-4E7E-8BD6-3450D93FD8FF}"
      DTS:ExecutableType="Microsoft.DataTransformationServices.Tasks.DTSProcessingTask.DTSProcessingTask, Microsoft.SqlServer.ASTasks, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Redeploy dims for Forklaring cube"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <ASProcessingData
          ConnectionName="UkuransKube"
          ProcessingCommands="&lt;Batch xmlns=&quot;http://schemas.microsoft.com/analysisservices/2003/engine&quot;&gt;&#xA;  &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot;&gt;&#xA;    &lt;Object&gt;&#xA;      &lt;DatabaseID&gt;Ukurans&lt;/DatabaseID&gt;&#xA;      &lt;DimensionID&gt;Flg Uroerte&lt;/DimensionID&gt;&#xA;    &lt;/Object&gt;&#xA;    &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;    &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;  &lt;/Process&gt;&#xA;  &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot;&gt;&#xA;    &lt;Object&gt;&#xA;      &lt;DatabaseID&gt;Ukurans&lt;/DatabaseID&gt;&#xA;      &lt;DimensionID&gt;Flg Nyt Mat36md&lt;/DimensionID&gt;&#xA;    &lt;/Object&gt;&#xA;    &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;    &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;  &lt;/Process&gt;&#xA;  &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot;&gt;&#xA;    &lt;Object&gt;&#xA;      &lt;DatabaseID&gt;Ukurans&lt;/DatabaseID&gt;&#xA;      &lt;DimensionID&gt;Fra Til Tid&lt;/DimensionID&gt;&#xA;    &lt;/Object&gt;&#xA;    &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;    &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;  &lt;/Process&gt;&#xA;  &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot;&gt;&#xA;    &lt;Object&gt;&#xA;      &lt;DatabaseID&gt;Ukurans&lt;/DatabaseID&gt;&#xA;      &lt;DimensionID&gt;Dim Aendring&lt;/DimensionID&gt;&#xA;    &lt;/Object&gt;&#xA;    &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;    &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;  &lt;/Process&gt;&#xA;  &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot;&gt;&#xA;    &lt;Object&gt;&#xA;      &lt;DatabaseID&gt;Ukurans&lt;/DatabaseID&gt;&#xA;      &lt;DimensionID&gt;Flg Indk12md&lt;/DimensionID&gt;&#xA;    &lt;/Object&gt;&#xA;    &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;    &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;  &lt;/Process&gt;&#xA;&lt;/Batch&gt;" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Redeploy dims for FT_Forklaring cube"
      DTS:CreationName="Microsoft.DataTransformationServices.Tasks.DTSProcessingTask.DTSProcessingTask, Microsoft.SqlServer.ASTasks, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Analysis Services Processing Task"
      DTS:DTSID="{DE04406D-AD5D-46C5-90AD-1E3D881C13E7}"
      DTS:ExecutableType="Microsoft.DataTransformationServices.Tasks.DTSProcessingTask.DTSProcessingTask, Microsoft.SqlServer.ASTasks, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Redeploy dims for FT_Forklaring cube"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <ASProcessingData
          ConnectionName="UkuransKube"
          ProcessingCommands="&lt;Batch xmlns=&quot;http://schemas.microsoft.com/analysisservices/2003/engine&quot;&gt;&#xA;  &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot;&gt;&#xA;    &lt;Object&gt;&#xA;      &lt;DatabaseID&gt;Ukurans&lt;/DatabaseID&gt;&#xA;      &lt;CubeID&gt;Forklaring&lt;/CubeID&gt;&#xA;    &lt;/Object&gt;&#xA;    &lt;Type&gt;ProcessFull&lt;/Type&gt;&#xA;    &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;  &lt;/Process&gt;&#xA;&lt;/Batch&gt;" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Redeploy dims for Nedskriv cube"
      DTS:CreationName="Microsoft.DataTransformationServices.Tasks.DTSProcessingTask.DTSProcessingTask, Microsoft.SqlServer.ASTasks, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Analysis Services Processing Task"
      DTS:DTSID="{399727C9-3A75-40E8-B105-84FD6CECB012}"
      DTS:ExecutableType="Microsoft.DataTransformationServices.Tasks.DTSProcessingTask.DTSProcessingTask, Microsoft.SqlServer.ASTasks, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Redeploy dims for Nedskriv cube"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <ASProcessingData
          ConnectionName="UkuransKube"
          ProcessingCommands="&lt;Batch xmlns=&quot;http://schemas.microsoft.com/analysisservices/2003/engine&quot;&gt;&#xA;  &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot;&gt;&#xA;    &lt;Object&gt;&#xA;      &lt;DatabaseID&gt;Ukurans&lt;/DatabaseID&gt;&#xA;      &lt;DimensionID&gt;Dim Tid&lt;/DimensionID&gt;&#xA;    &lt;/Object&gt;&#xA;    &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;    &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;  &lt;/Process&gt;&#xA;  &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot;&gt;&#xA;    &lt;Object&gt;&#xA;      &lt;DatabaseID&gt;Ukurans&lt;/DatabaseID&gt;&#xA;      &lt;DimensionID&gt;Dim Fabrik&lt;/DimensionID&gt;&#xA;    &lt;/Object&gt;&#xA;    &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;    &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;  &lt;/Process&gt;&#xA;  &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot;&gt;&#xA;    &lt;Object&gt;&#xA;      &lt;DatabaseID&gt;Ukurans&lt;/DatabaseID&gt;&#xA;      &lt;DimensionID&gt;Fra Til Tid&lt;/DimensionID&gt;&#xA;    &lt;/Object&gt;&#xA;    &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;    &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;  &lt;/Process&gt;&#xA;  &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot;&gt;&#xA;    &lt;Object&gt;&#xA;      &lt;DatabaseID&gt;Ukurans&lt;/DatabaseID&gt;&#xA;      &lt;DimensionID&gt;FLN Type&lt;/DimensionID&gt;&#xA;    &lt;/Object&gt;&#xA;    &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;    &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;  &lt;/Process&gt;&#xA;  &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot;&gt;&#xA;    &lt;Object&gt;&#xA;      &lt;DatabaseID&gt;Ukurans&lt;/DatabaseID&gt;&#xA;      &lt;DimensionID&gt;Dim Fabrik Materiale&lt;/DimensionID&gt;&#xA;    &lt;/Object&gt;&#xA;    &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;    &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;  &lt;/Process&gt;&#xA;  &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot;&gt;&#xA;    &lt;Object&gt;&#xA;      &lt;DatabaseID&gt;Ukurans&lt;/DatabaseID&gt;&#xA;      &lt;DimensionID&gt;Dim Materiale&lt;/DimensionID&gt;&#xA;    &lt;/Object&gt;&#xA;    &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;    &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;  &lt;/Process&gt;&#xA;  &lt;Process xmlns:xsd=&quot;http://www.w3.org/2001/XMLSchema&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:ddl2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2&quot; xmlns:ddl2_2=&quot;http://schemas.microsoft.com/analysisservices/2003/engine/2/2&quot; xmlns:ddl100_100=&quot;http://schemas.microsoft.com/analysisservices/2008/engine/100/100&quot; xmlns:ddl200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200&quot; xmlns:ddl200_200=&quot;http://schemas.microsoft.com/analysisservices/2010/engine/200/200&quot; xmlns:ddl300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300&quot; xmlns:ddl300_300=&quot;http://schemas.microsoft.com/analysisservices/2011/engine/300/300&quot; xmlns:ddl400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400&quot; xmlns:ddl400_400=&quot;http://schemas.microsoft.com/analysisservices/2012/engine/400/400&quot;&gt;&#xA;    &lt;Object&gt;&#xA;      &lt;DatabaseID&gt;Ukurans&lt;/DatabaseID&gt;&#xA;      &lt;DimensionID&gt;LN Type&lt;/DimensionID&gt;&#xA;    &lt;/Object&gt;&#xA;    &lt;Type&gt;ProcessUpdate&lt;/Type&gt;&#xA;    &lt;WriteBackTableCreation&gt;UseExisting&lt;/WriteBackTableCreation&gt;&#xA;  &lt;/Process&gt;&#xA;&lt;/Batch&gt;" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Tilføj Primary Key for Dim_Fabrik_Materiale"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{ED63BD30-C0F8-45CE-B8E4-899E27806E7C}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Tilføj Primary Key for Dim_Fabrik_Materiale"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="-- Ajourfør primary key for Dim_Fabrik_Materiale&#xA;&#xA;Update a&#xA;set a.Dim_Fabrik_Materiale = isnull(b.PK_ID, 0)&#xA;-- Select b.PK_ID, a.*&#xA;From edw.FT_Forklaring a&#xA;Left Join edw.Dim_Fabrik_Materiale b on a.Dim_Fabrik = b.Fabrik and a.Materiale = b.Materiale &#xA;&#x9;and right(a.FraTil_Tid,6) &gt;= GyldigFra &#xA;&#x9;and right(a.FraTil_Tid,6) &lt;= GyldigTil&#xA;Where a.FraTil_Tid = ( select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'PrimoDato') &#xA;&#x9;&#x9;+ '-' +( select replace(left(Vaerdi, 7), '-', '') from [edw].[MD_Styringstabel] where parameter = 'UltimoDato')" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{EDE3AC29-3528-49D8-BC73-FEA853EE68D3}"
      DTS:From="Package\Overfør data til FT_Nedskriv"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Find laveste Nedskrivningstype og - procent" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 1]"
      DTS:CreationName=""
      DTS:DTSID="{4DBBAD74-C155-4B19-A6EB-453D729E2044}"
      DTS:From="Package\Redeploy dims for Nedskriv cube"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 1"
      DTS:To="Package\Deploy Nedskriv cube" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 10]"
      DTS:CreationName=""
      DTS:DTSID="{03DAEE3D-A673-4678-9F24-831346141A75}"
      DTS:From="Package\Ajourføring af flag via views"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 10"
      DTS:To="Package\Tilføj Primary Key for Dim_Fabrik_Materiale" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 11]"
      DTS:CreationName=""
      DTS:DTSID="{9D1E9C68-3DEC-4B1E-8D0B-0E4A9F176449}"
      DTS:From="Package\Redeploy dims for FT_Forklaring cube"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 11"
      DTS:To="Package\Opdater nøgletal" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 12]"
      DTS:CreationName=""
      DTS:DTSID="{863C0764-6EBB-4894-8BDB-39AB13A225E3}"
      DTS:From="Package\Overfør data fra  view vedrørende reelle ekstra-nedskrivninger"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 12"
      DTS:To="Package\Overfør data fra views vedrørende delta-summer" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 13]"
      DTS:CreationName=""
      DTS:DTSID="{CBA4A8E4-7125-49B6-B894-8CC4B2575113}"
      DTS:From="Package\Overfør data vedr urørte beholdninger"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 13"
      DTS:To="Package\Ajourføring af flag via views" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 14]"
      DTS:CreationName=""
      DTS:DTSID="{93926562-CC6B-422D-A7DA-A653EAF235BC}"
      DTS:From="Package\Overfør data fra views vedrørende delta-summer"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 14"
      DTS:To="Package\Overfør data vedr urørte beholdninger" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 15]"
      DTS:CreationName=""
      DTS:DTSID="{75D6F8A5-6456-4DB4-A572-BBF2C3D4FD47}"
      DTS:From="Package\Tilføj Primary Key for Dim_Fabrik_Materiale"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 15"
      DTS:To="Package\Kør Tjek-rapport for FT_Forklaring" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 2]"
      DTS:CreationName=""
      DTS:DTSID="{E34A1153-09EF-457F-864E-6235C0CF83C4}"
      DTS:From="Package\Deploy Nedskriv cube"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 2"
      DTS:To="Package\Overfør data fra view FT_Forklaring til FT_Forklaring tabel" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 3]"
      DTS:CreationName=""
      DTS:DTSID="{85E22338-0F30-40F0-97B6-00086CAC446A}"
      DTS:From="Package\Overfør data fra view FT_Forklaring til FT_Forklaring tabel"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 3"
      DTS:To="Package\Overfør data fra  view vedrørende reelle ekstra-nedskrivninger" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 4]"
      DTS:CreationName=""
      DTS:DTSID="{8A5EE8C6-1DB6-414F-BAA8-8B610332F716}"
      DTS:From="Package\Redeploy dims for Forklaring cube"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 4"
      DTS:To="Package\Redeploy dims for FT_Forklaring cube" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 5]"
      DTS:CreationName=""
      DTS:DTSID="{FD75AFCC-CED2-422D-B0F8-29777A0FC198}"
      DTS:From="Package\Find laveste Nedskrivningstype og - procent"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 5"
      DTS:To="Package\Påsæt 'AEPD' hvis beholdning sidst var 0" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 6]"
      DTS:CreationName=""
      DTS:DTSID="{5B0D6D16-21DC-4DF1-93B7-8AC27C1C6EBE}"
      DTS:From="Package\Påsæt 'AEPD' hvis beholdning sidst var 0"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 6"
      DTS:To="Package\Påsæt FLNType" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 7]"
      DTS:CreationName=""
      DTS:DTSID="{FAF266AC-229E-4CE4-ACEE-D831672CCC22}"
      DTS:From="Package\Påsæt FLNType"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 7"
      DTS:To="Package\Kør Tjek-rapport for FT_Nedskriv" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 8]"
      DTS:CreationName=""
      DTS:DTSID="{DE4C9B55-142E-45E5-AF99-2BA2C666DB1D}"
      DTS:From="Package\Kør Tjek-rapport for FT_Nedskriv"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 8"
      DTS:To="Package\Redeploy dims for Nedskriv cube" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 9]"
      DTS:CreationName=""
      DTS:DTSID="{85030486-6F18-4FE7-B030-4CE3EC6BA627}"
      DTS:From="Package\Kør Tjek-rapport for FT_Forklaring"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 9"
      DTS:To="Package\Redeploy dims for Forklaring cube" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="sql11">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="64" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="219,44"
          Id="Package\Ajourføring af flag via views"
          TopLeft="275.61320754717,157.650943396226" />
        <NodeLayout
          Size="219,44"
          Id="Package\Deploy Nedskriv cube"
          TopLeft="5.5,461.952830188679" />
        <NodeLayout
          Size="219,44"
          Id="Package\Find laveste Nedskrivningstype og - procent"
          TopLeft="5.5,81.5754716981132" />
        <NodeLayout
          Size="219,44"
          Id="Package\Kør Tjek-rapport for FT_Forklaring"
          TopLeft="275.61320754717,5.5" />
        <NodeLayout
          Size="219,44"
          Id="Package\Kør Tjek-rapport for FT_Nedskriv"
          TopLeft="5.5,309.801886792453" />
        <NodeLayout
          Size="219,44"
          Id="Package\Opdater nøgletal"
          TopLeft="545.801886792453,157.650943396226" />
        <NodeLayout
          Size="375,42"
          Id="Package\Overfør data fra  view vedrørende reelle ekstra-nedskrivninger"
          TopLeft="275.61320754717,386.594339622642" />
        <NodeLayout
          Size="219,44"
          Id="Package\Overfør data fra view FT_Forklaring til FT_Forklaring tabel"
          TopLeft="275.61320754717,461.952830188679" />
        <NodeLayout
          Size="219,44"
          Id="Package\Overfør data fra views vedrørende delta-summer"
          TopLeft="275.61320754717,311.38679245283" />
        <NodeLayout
          Size="219,44"
          Id="Package\Overfør data til FT_Nedskriv"
          TopLeft="5.5,5.5" />
        <NodeLayout
          Size="219,44"
          Id="Package\Overfør data vedr urørte beholdninger"
          TopLeft="275.61320754717,236.179245283019" />
        <NodeLayout
          Size="219,44"
          Id="Package\Påsæt 'AEPD' hvis beholdning sidst var 0"
          TopLeft="5.5,157.650943396226" />
        <NodeLayout
          Size="219,44"
          Id="Package\Påsæt FLNType"
          TopLeft="5.5,233.72641509434" />
        <NodeLayout
          Size="219,44"
          Id="Package\Redeploy dims for Forklaring cube"
          TopLeft="545.801886792453,5.5" />
        <NodeLayout
          Size="219,44"
          Id="Package\Redeploy dims for FT_Forklaring cube"
          TopLeft="545.801886792453,81.5754716981132" />
        <NodeLayout
          Size="235,42"
          Id="Package\Redeploy dims for Nedskriv cube"
          TopLeft="5.5,385.877358490566" />
        <NodeLayout
          Size="219,44"
          Id="Package\Tilføj Primary Key for Dim_Fabrik_Materiale"
          TopLeft="275.61320754717,81.5754716981132" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="114.820754716981,49.4245283018868">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,32.1509433962264"
              Start="0,0"
              End="0,24.6509433962264">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.6509433962264" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 1]"
          TopLeft="123,427.877358490566">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-8,34.075471698113"
              Start="0,0"
              End="-8,26.575471698113">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,13.0377358490565" />
                  <mssgle:CubicBezierSegment
                    Point1="0,13.0377358490565"
                    Point2="0,17.0377358490565"
                    Point3="-4,17.0377358490565" />
                  <mssgle:LineSegment
                    End="-4,17.0377358490565" />
                  <mssgle:CubicBezierSegment
                    Point1="-4,17.0377358490565"
                    Point2="-8,17.0377358490565"
                    Point3="-8,21.0377358490565" />
                  <mssgle:LineSegment
                    End="-8,26.575471698113" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 10]"
          TopLeft="384.933962264151,157.650943396226">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,-32.1509433962264"
              Start="0,0"
              End="0,-24.6509433962264">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-24.6509433962264" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 11]"
          TopLeft="655.122641509434,125.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,32.1509433962264"
              Start="0,0"
              End="0,24.6509433962264">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.6509433962264" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 12]"
          TopLeft="463.11320754717,386.594339622642">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-78,-31.2075471698113"
              Start="0,0"
              End="-78,-23.7075471698113">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-11.6037735849057" />
                  <mssgle:CubicBezierSegment
                    Point1="0,-11.6037735849057"
                    Point2="0,-15.6037735849057"
                    Point3="-4,-15.6037735849057" />
                  <mssgle:LineSegment
                    End="-74,-15.6037735849057" />
                  <mssgle:CubicBezierSegment
                    Point1="-74,-15.6037735849057"
                    Point2="-78,-15.6037735849057"
                    Point3="-78,-19.6037735849057" />
                  <mssgle:LineSegment
                    End="-78,-23.7075471698113" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 13]"
          TopLeft="384.933962264151,236.179245283019">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,-34.6037735849057"
              Start="0,0"
              End="0,-27.1037735849057">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-27.1037735849057" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 14]"
          TopLeft="384.933962264151,311.38679245283">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,-31.2830188679245"
              Start="0,0"
              End="0,-23.7830188679245">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-23.7830188679245" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 15]"
          TopLeft="384.933962264151,81.5754716981132">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,-32.1509433962264"
              Start="0,0"
              End="0,-24.6509433962264">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-24.6509433962264" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 2]"
          TopLeft="224.141509433962,483.915094339623">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="51.4716981132075,0"
              Start="0,0"
              End="43.9716981132075,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="43.9716981132075,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 3]"
          TopLeft="385.11320754717,461.952830188679">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="78,-33.3584905660377"
              Start="0,0"
              End="78,-25.8584905660377">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,-12.6792452830189" />
                  <mssgle:CubicBezierSegment
                    Point1="0,-12.6792452830189"
                    Point2="0,-16.6792452830189"
                    Point3="4,-16.6792452830189" />
                  <mssgle:LineSegment
                    End="74,-16.6792452830189" />
                  <mssgle:CubicBezierSegment
                    Point1="74,-16.6792452830189"
                    Point2="78,-16.6792452830189"
                    Point3="78,-20.6792452830189" />
                  <mssgle:LineSegment
                    End="78,-25.8584905660377" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 4]"
          TopLeft="655.122641509434,49.4245283018868">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,32.1509433962264"
              Start="0,0"
              End="0,24.6509433962264">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.6509433962264" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 5]"
          TopLeft="114.820754716981,125.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,32.1509433962264"
              Start="0,0"
              End="0,24.6509433962264">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.6509433962264" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 6]"
          TopLeft="114.820754716981,201.575471698113">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,32.1509433962264"
              Start="0,0"
              End="0,24.6509433962264">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.6509433962264" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 7]"
          TopLeft="114.820754716981,277.650943396226">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,32.1509433962264"
              Start="0,0"
              End="0,24.6509433962264">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.6509433962264" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 8]"
          TopLeft="115,353.801886792453">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="8,32.075471698113"
              Start="0,0"
              End="8,24.575471698113">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,12.0377358490565" />
                  <mssgle:CubicBezierSegment
                    Point1="0,12.0377358490565"
                    Point2="0,16.0377358490565"
                    Point3="4,16.0377358490565" />
                  <mssgle:LineSegment
                    End="4,16.0377358490565" />
                  <mssgle:CubicBezierSegment
                    Point1="4,16.0377358490565"
                    Point2="8,16.0377358490565"
                    Point3="8,20.0377358490565" />
                  <mssgle:LineSegment
                    End="8,24.575471698113" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 9]"
          TopLeft="494.254716981132,27.4622641509434">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="51.5471698113208,0"
              Start="0,0"
              End="44.0471698113208,0">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="44.0471698113208,0" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>