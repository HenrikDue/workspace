<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="11/13/2013 1:01:52 PM"
  DTS:CreationName="SSIS.Package.3"
  DTS:CreatorComputerName="DSB075473"
  DTS:CreatorName="DSB\KM2406"
  DTS:DTSID="{0D29B523-D2E9-4A02-B1EA-F56D5764D479}"
  DTS:EnableConfig="True"
  DTS:ExecutableType="SSIS.Package.3"
  DTS:LastModifiedProductVersion="11.0.5583.0"
  DTS:LocaleID="1030"
  DTS:ObjectName="E_edw_dt_FT_Forklaring_ogkuber"
  DTS:PackageType="5"
  DTS:ProtectionLevel="0"
  DTS:VersionBuild="252"
  DTS:VersionGUID="{7BA15BE7-0EA9-4BBD-B1B7-27B1F87751D9}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">6</DTS:Property>
  <DTS:Configurations>
    <DTS:Configuration
      DTS:ConfigurationString="\\gbdfs1\DSBDFS\Økonomi\KONC-POEM\70_BI\Projekter - debug\Ukurans\ServerOgDatabase.dtsConfig"
      DTS:ConfigurationType="1"
      DTS:CreationName=""
      DTS:DTSID="{C4B312DF-4145-4384-B4BB-D2E18F6749BC}"
      DTS:ObjectName="ServerogDatabase" />
  </DTS:Configurations>
  <DTS:Variables>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{3ECC997C-4E4F-4CB8-AF8C-9FC67A954C1A}"
      DTS:IncludeInDebugDump="6789"
      DTS:Namespace="User"
      DTS:ObjectName="Counter">
      <DTS:VariableValue
        DTS:DataType="3">0</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{DADF9533-0DEA-44F2-ADA2-8DC01FC22BA5}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="DATABASE">
      <DTS:VariableValue
        DTS:DataType="8">Ukurans</DTS:VariableValue>
    </DTS:Variable>
    <DTS:Variable
      DTS:CreationName=""
      DTS:DTSID="{27C5BAFD-2883-4AA7-BF72-320CDDFF1911}"
      DTS:IncludeInDebugDump="2345"
      DTS:Namespace="User"
      DTS:ObjectName="SERVER">
      <DTS:VariableValue
        DTS:DataType="8">mssqlp01\alpha</DTS:VariableValue>
    </DTS:Variable>
  </DTS:Variables>
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Opdatering af Median DUF"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{A4A55DC3-9B65-4E74-B422-0E0D5AE7FBE6}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Opdatering af Median DUF"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="If object_id('tempdb..#LitraGr') is not null drop table #LitraGr&#xA;Select distinct Dim_Vaerdi&#xA;Into #LitraGr&#xA;From edw.FT_NoegleTal_BU_150629_1_Test&#xA;Where Rap_Dim = 'LitraGr'&#xA;Order by Dim_Vaerdi desc&#xA;-- Select * from #LitraGr order by Dim_Vaerdi desc&#xA;&#xA;If object_id('tempdb..#Fabrik') is not null drop table #Fabrik&#xA;Select distinct Dim_Vaerdi&#xA;Into #Fabrik&#xA;From edw.FT_NoegleTal_BU_150629_1_Test&#xA;Where Rap_Dim = 'Fabrik'&#xA;Order by Dim_Vaerdi desc&#xA;-- Select * from #Fabrik order by Dim_Vaerdi&#xA;&#xA;If object_id('tempdb..#LNType') is not null drop table #LNType&#xA;Select distinct Dim_Vaerdi&#xA;Into #LNType&#xA;From edw.FT_NoegleTal_BU_150629_1_Test&#xA;Where Rap_Dim = 'LNType'&#xA;Order by Dim_Vaerdi desc&#xA;-- Select * from #LNType order by Dim_Vaerdi&#xA;&#xA;If object_id('tempdb..#FLNType') is not null drop table #FLNType&#xA;Select distinct Dim_Vaerdi&#xA;Into #FLNType&#xA;From edw.FT_NoegleTal_BU_150629_1_Test&#xA;Where Rap_Dim = 'FLNType'&#xA;Order by Dim_Vaerdi desc&#xA;-- Select * from #FLNType order by Dim_Vaerdi&#xA;&#xA;If object_id('tempdb..#StatusGr') is not null drop table #StatusGr&#xA;Select distinct Dim_Vaerdi&#xA;Into #StatusGr&#xA;From edw.FT_NoegleTal_BU_150629_1_Test&#xA;Where Rap_Dim = 'StatusGr'&#xA;Order by Dim_Vaerdi desc&#xA;-- Opdatering af Median DUF&#xA;&#xA;-- Deklarer cursor til LitraGruppe&#xA;Declare LitraGr cursor fast_forward&#xA;For select Dim_Vaerdi from #LitraGr&#xA;Declare @LitraGrNavn varchar(15)&#xA;Open LitraGr&#xA;Fetch next from LitraGr into @LitraGrNavn&#xA;&#xA;-- Start loop for opdatering af median DUF på LitraGruppe, &#xA;While @@fetch_status = 0&#xA;Begin&#xA;&#xA;-- LitraGruppe, specifik litra&#xA;Update z&#xA;set z.Med_DUF =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.LitraGr2 = @LitraGrNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.LitraGr2 = @LitraGrNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'LitraGr'&#xA;&#x9;and Dim_Vaerdi = @LitraGrNavn&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;-- Opdater for NULL (alle litra)&#xA;Update z&#xA;set z.Med_DUF =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @LitraGrNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @LitraGrNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'LitraGr'&#xA;&#x9;and Dim_Vaerdi is null&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;Fetch next from LitraGr into @LitraGrNavn&#xA;--&#x9;select @LitraGrNavn&#xA;End&#xA;Close LitraGr&#xA;Deallocate LitraGr&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;-- Deklarer cursor til Fabrik&#xA;Declare Fabrik cursor fast_forward&#xA;For select Dim_Vaerdi from #Fabrik&#xA;Declare @FabrikNavn varchar(15)&#xA;Open Fabrik&#xA;Fetch next from Fabrik into @FabrikNavn&#xA;&#xA;-- Start loop for opdatering af median DUF på Fabrik, &#xA;While @@fetch_status = 0&#xA;Begin&#xA;&#xA;-- Fabrik, specifik &#xA;Update z&#xA;set z.Med_DUF =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and a.Dim_Fabrik = @FabrikNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and a.Dim_Fabrik = @FabrikNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'Fabrik'&#xA;&#x9;and Dim_Vaerdi = @FabrikNavn&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;-- Opdater for NULL (alle fabrikker)&#xA;Update z&#xA;set z.Med_DUF =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @FabrikNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @FabrikNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'Fabrik'&#xA;&#x9;and Dim_Vaerdi is null&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;Fetch next from Fabrik into @FabrikNavn&#xA;End&#xA;Close Fabrik&#xA;Deallocate Fabrik&#xA;&#xA;&#xA;&#xA;&#xA;-- Deklarer cursor til LNType&#xA;Declare LNType cursor fast_forward&#xA;For select Dim_Vaerdi from #LNType&#xA;Declare @LNTypeNavn varchar(15)&#xA;Open LNType&#xA;Fetch next from LNType into @LNTypeNavn&#xA;&#xA;-- Start loop for opdatering af median DUF på Laveste NedskrivningsTyper&#xA;While @@fetch_status = 0&#xA;Begin&#xA;&#xA;-- LNType, specifik &#xA;Update z&#xA;set z.Med_DUF =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and a.LNType = @LNTypeNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and a.LNType = @LNTypeNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'LNType'&#xA;&#x9;and Dim_Vaerdi = @LNTypeNavn&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;-- Opdater for NULL (alle LNTyper)&#xA;Update z&#xA;set z.Med_DUF =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @LNTypeNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @LNTypeNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'LNType'&#xA;&#x9;and Dim_Vaerdi is null&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;Fetch next from LNType into @LNTypeNavn&#xA;End&#xA;Close LNType&#xA;Deallocate LNType&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;-- Deklarer cursor til FLNType&#xA;Declare FLNType cursor fast_forward&#xA;For select Dim_Vaerdi from #FLNType&#xA;Declare @FLNTypeNavn varchar(15)&#xA;Open FLNType&#xA;Fetch next from FLNType into @FLNTypeNavn&#xA;&#xA;-- Start loop for opdatering af median DUF på Forrige Laveste NedskrivningsTyper, &#xA;While @@fetch_status = 0&#xA;Begin&#xA;&#xA;-- FLNType, specifik &#xA;Update z&#xA;set z.Med_DUF =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and a.FLNType = @FLNTypeNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and a.FLNType = @FLNTypeNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'FLNType'&#xA;&#x9;and Dim_Vaerdi = @FLNTypeNavn&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;-- Opdater for NULL (alle FLNTyper)&#xA;Update z&#xA;set z.Med_DUF =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @FLNTypeNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @FLNTypeNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'FLNType'&#xA;&#x9;and Dim_Vaerdi is null&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;Fetch next from FLNType into @FLNTypeNavn&#xA;End&#xA;Close FLNType&#xA;Deallocate FLNType&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;-- Deklarer cursor til StatusGruppe&#xA;Declare StatusGr cursor fast_forward&#xA;For select Dim_Vaerdi from #StatusGr&#xA;Declare @StatusGrNavn varchar(15)&#xA;Open StatusGr&#xA;Fetch next from StatusGr into @StatusGrNavn&#xA;&#xA;-- Start loop for opdatering af median DUF på StatusGruppe, &#xA;While @@fetch_status = 0&#xA;Begin&#xA;&#xA;-- StatusGruppe, specifik litra&#xA;Update z&#xA;set z.Med_DUF =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.StatusGr2 = @StatusGrNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.StatusGr2 = @StatusGrNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'StatusGr'&#xA;&#x9;and Dim_Vaerdi = @StatusGrNavn&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;-- Opdater for NULL (alle litra)&#xA;Update z&#xA;set z.Med_DUF =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @StatusGrNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.DUF)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where DUF is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @StatusGrNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by DUF &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'StatusGr'&#xA;&#x9;and Dim_Vaerdi is null&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;Fetch next from StatusGr into @StatusGrNavn&#xA;--&#x9;select @StatusGrNavn&#xA;End&#xA;Close StatusGr&#xA;Deallocate StatusGr&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Opdatering af Median RID"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{6AD469B7-3BE7-4229-8D9E-43C939FBF044}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Opdatering af Median RID"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F2A94D2E-B5B5-4BEA-825C-265DA8BF970D}"
          SQLTask:SqlStatementSource="If object_id('tempdb..#LitraGr') is not null drop table #LitraGr&#xA;Select distinct Dim_Vaerdi&#xA;Into #LitraGr&#xA;From edw.FT_NoegleTal_BU_150629_1_Test&#xA;Where Rap_Dim = 'LitraGr'&#xA;Order by Dim_Vaerdi desc&#xA;-- Select * from #LitraGr order by Dim_Vaerdi desc&#xA;&#xA;If object_id('tempdb..#Fabrik') is not null drop table #Fabrik&#xA;Select distinct Dim_Vaerdi&#xA;Into #Fabrik&#xA;From edw.FT_NoegleTal_BU_150629_1_Test&#xA;Where Rap_Dim = 'Fabrik'&#xA;Order by Dim_Vaerdi desc&#xA;-- Select * from #Fabrik order by Dim_Vaerdi&#xA;&#xA;If object_id('tempdb..#LNType') is not null drop table #LNType&#xA;Select distinct Dim_Vaerdi&#xA;Into #LNType&#xA;From edw.FT_NoegleTal_BU_150629_1_Test&#xA;Where Rap_Dim = 'LNType'&#xA;Order by Dim_Vaerdi desc&#xA;-- Select * from #LNType order by Dim_Vaerdi&#xA;&#xA;If object_id('tempdb..#FLNType') is not null drop table #FLNType&#xA;Select distinct Dim_Vaerdi&#xA;Into #FLNType&#xA;From edw.FT_NoegleTal_BU_150629_1_Test&#xA;Where Rap_Dim = 'FLNType'&#xA;Order by Dim_Vaerdi desc&#xA;-- Select * from #FLNType order by Dim_Vaerdi&#xA;&#xA;If object_id('tempdb..#StatusGr') is not null drop table #StatusGr&#xA;Select distinct Dim_Vaerdi&#xA;Into #StatusGr&#xA;From edw.FT_NoegleTal_BU_150629_1_Test&#xA;Where Rap_Dim = 'StatusGr'&#xA;Order by Dim_Vaerdi desc&#xA;&#xA;&#xA;&#xA;-- Opdatering af Median RID&#xA;&#xA;-- Deklarer cursor til LitraGruppe&#xA;Declare LitraGr cursor fast_forward&#xA;For select Dim_Vaerdi from #LitraGr&#xA;Declare @LitraGrNavn varchar(15)&#xA;Open LitraGr&#xA;Fetch next from LitraGr into @LitraGrNavn&#xA;&#xA;-- Start loop for opdatering af median RID på LitraGruppe, &#xA;While @@fetch_status = 0&#xA;Begin&#xA;&#xA;-- LitraGruppe, specifik litra&#xA;Update z&#xA;set z.Med_RID =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.LitraGr2 = @LitraGrNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.LitraGr2 = @LitraGrNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'LitraGr'&#xA;&#x9;and Dim_Vaerdi = @LitraGrNavn&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;-- Opdater for NULL (alle litra)&#xA;Update z&#xA;set z.Med_RID =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @LitraGrNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @LitraGrNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'LitraGr'&#xA;&#x9;and Dim_Vaerdi is null&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;Fetch next from LitraGr into @LitraGrNavn&#xA;--&#x9;select @LitraGrNavn&#xA;End&#xA;Close LitraGr&#xA;Deallocate LitraGr&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;-- Deklarer cursor til Fabrik&#xA;Declare Fabrik cursor fast_forward&#xA;For select Dim_Vaerdi from #Fabrik&#xA;Declare @FabrikNavn varchar(15)&#xA;Open Fabrik&#xA;Fetch next from Fabrik into @FabrikNavn&#xA;&#xA;-- Start loop for opdatering af median RID på Fabrik, &#xA;While @@fetch_status = 0&#xA;Begin&#xA;&#xA;-- Fabrik, specifik &#xA;Update z&#xA;set z.Med_RID =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and a.Dim_Fabrik = @FabrikNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and a.Dim_Fabrik = @FabrikNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'Fabrik'&#xA;&#x9;and Dim_Vaerdi = @FabrikNavn&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;-- Opdater for NULL (alle fabrikker)&#xA;Update z&#xA;set z.Med_RID =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @FabrikNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @FabrikNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'Fabrik'&#xA;&#x9;and Dim_Vaerdi is null&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;Fetch next from Fabrik into @FabrikNavn&#xA;End&#xA;Close Fabrik&#xA;Deallocate Fabrik&#xA;&#xA;&#xA;&#xA;&#xA;-- Deklarer cursor til LNType&#xA;Declare LNType cursor fast_forward&#xA;For select Dim_Vaerdi from #LNType&#xA;Declare @LNTypeNavn varchar(15)&#xA;Open LNType&#xA;Fetch next from LNType into @LNTypeNavn&#xA;&#xA;-- Start loop for opdatering af median RID på Laveste NedskrivningsTyper&#xA;While @@fetch_status = 0&#xA;Begin&#xA;&#xA;-- LNType, specifik &#xA;Update z&#xA;set z.Med_RID =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and a.LNType = @LNTypeNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and a.LNType = @LNTypeNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'LNType'&#xA;&#x9;and Dim_Vaerdi = @LNTypeNavn&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;-- Opdater for NULL (alle LNTyper)&#xA;Update z&#xA;set z.Med_RID =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @LNTypeNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @LNTypeNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'LNType'&#xA;&#x9;and Dim_Vaerdi is null&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;Fetch next from LNType into @LNTypeNavn&#xA;End&#xA;Close LNType&#xA;Deallocate LNType&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;-- Deklarer cursor til FLNType&#xA;Declare FLNType cursor fast_forward&#xA;For select Dim_Vaerdi from #FLNType&#xA;Declare @FLNTypeNavn varchar(15)&#xA;Open FLNType&#xA;Fetch next from FLNType into @FLNTypeNavn&#xA;&#xA;-- Start loop for opdatering af median RID på Forrige Laveste NedskrivningsTyper, &#xA;While @@fetch_status = 0&#xA;Begin&#xA;&#xA;-- FLNType, specifik &#xA;Update z&#xA;set z.Med_RID =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and a.FLNType = @FLNTypeNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and a.FLNType = @FLNTypeNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'FLNType'&#xA;&#x9;and Dim_Vaerdi = @FLNTypeNavn&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;-- Opdater for NULL (alle FLNTyper)&#xA;Update z&#xA;set z.Med_RID =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @FLNTypeNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @FLNTypeNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'FLNType'&#xA;&#x9;and Dim_Vaerdi is null&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;Fetch next from FLNType into @FLNTypeNavn&#xA;End&#xA;Close FLNType&#xA;Deallocate FLNType&#xA;&#xA;&#xA;&#xA;&#xA;&#xA;-- Deklarer cursor til StatusGruppe&#xA;Declare StatusGr cursor fast_forward&#xA;For select Dim_Vaerdi from #StatusGr&#xA;Declare @StatusGrNavn varchar(15)&#xA;Open StatusGr&#xA;Fetch next from StatusGr into @StatusGrNavn&#xA;&#xA;-- Start loop for opdatering af median RID på StatusGruppe, &#xA;While @@fetch_status = 0&#xA;Begin&#xA;&#xA;-- StatusGruppe, specifik litra&#xA;Update z&#xA;set z.Med_RID =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.StatusGr2 = @StatusGrNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and b.StatusGr2 = @StatusGrNavn&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'StatusGr'&#xA;&#x9;and Dim_Vaerdi = @StatusGrNavn&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#xA;-- Opdater for NULL (alle litra)&#xA;Update z&#xA;set z.Med_RID =&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select min(x.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @StatusGrNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID desc &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) x)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+&#x9;&#x9;&#x9;&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;(select max(y.RID)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from&#x9;&#x9;(select top 50 percent RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from edw.FT_Nedskriv a&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;left join edw.Dim_Materiale b on a.Dim_Materiale = b.PK_ID&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where RID is not null&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;--&#x9;and @StatusGrNavn = 'NULL'&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;and FraTil_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'PrimoDato') + '-' &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;+(select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;order by RID &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9;) y)&#xA;&#x9;&#x9;&#x9;&#x9;&#x9;&#x9; )&#xA;&#x9;&#x9;&#x9;&#x9;/(2)) --as Median&#xA;From edw.FT_NoegleTal_BU_150629_1_Test z&#xA;Where Rap_Dim = 'StatusGr'&#xA;&#x9;and Dim_Vaerdi is null&#xA;&#x9;and Dim_Tid = (select replace(left(Vaerdi, 7), '-', '') &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;from [edw].[MD_Styringstabel] &#xA;&#x9;&#x9;&#x9;&#x9;&#x9;where parameter = 'UltimoDato')&#xA;&#xA;Fetch next from StatusGr into @StatusGrNavn&#xA;--&#x9;select @StatusGrNavn&#xA;End&#xA;Close StatusGr&#xA;Deallocate StatusGr" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Task1"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:Disabled="True"
      DTS:DTSID="{fa83a462-1ba1-4d88-9bba-f54603e55775}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Task1"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F9ADB02B-6B52-48BD-B25D-569632CD9925}" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Task4"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:Disabled="True"
      DTS:DTSID="{629E909D-E8C1-453E-A290-3092DF6A3E44}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Task4"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F9ADB02B-6B52-48BD-B25D-569632CD9925}" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Task5"
      DTS:CreationName="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:Description="Execute SQL Task"
      DTS:Disabled="True"
      DTS:DTSID="{E71D95F1-CB4A-471E-8191-5A8C6A2938EE}"
      DTS:ExecutableType="Microsoft.SqlServer.Dts.Tasks.ExecuteSQLTask.ExecuteSQLTask, Microsoft.SqlServer.SQLTask, Version=11.0.0.0, Culture=neutral, PublicKeyToken=89845dcd8080cc91"
      DTS:LocaleID="-1"
      DTS:ObjectName="Task5"
      DTS:TaskContact="Execute SQL Task; Microsoft Corporation; Microsoft SQL Server 2008 R2; © 2007 Microsoft Corporation; All Rights Reserved;http://www.microsoft.com/sql/support/default.asp;1"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{F9ADB02B-6B52-48BD-B25D-569632CD9925}" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint]"
      DTS:CreationName=""
      DTS:DTSID="{EDE3AC29-3528-49D8-BC73-FEA853EE68D3}"
      DTS:From="Package\Task1"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint"
      DTS:To="Package\Opdatering af Median RID" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 5]"
      DTS:CreationName=""
      DTS:DTSID="{FD75AFCC-CED2-422D-B0F8-29777A0FC198}"
      DTS:From="Package\Opdatering af Median RID"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 5"
      DTS:To="Package\Opdatering af Median DUF" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 6]"
      DTS:CreationName=""
      DTS:DTSID="{5B0D6D16-21DC-4DF1-93B7-8AC27C1C6EBE}"
      DTS:From="Package\Opdatering af Median DUF"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 6"
      DTS:To="Package\Task4" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 7]"
      DTS:CreationName=""
      DTS:DTSID="{FAF266AC-229E-4CE4-ACEE-D831672CCC22}"
      DTS:From="Package\Task4"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 7"
      DTS:To="Package\Task5" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="sql11">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="219,44"
          Id="Package\Opdatering af Median DUF"
          TopLeft="5.5,157.650943396226" />
        <NodeLayout
          Size="219,44"
          Id="Package\Opdatering af Median RID"
          TopLeft="5.5,81.5754716981132" />
        <NodeLayout
          Size="219,44"
          Id="Package\Task1"
          TopLeft="5.5,5.5" />
        <NodeLayout
          Size="219,44"
          Id="Package\Task4"
          TopLeft="5.5,233.72641509434" />
        <NodeLayout
          Size="219,44"
          Id="Package\Task5"
          TopLeft="5.5,309.801886792453" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint]"
          TopLeft="114.820754716981,49.4245283018868">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,32.1509433962264"
              Start="0,0"
              End="0,24.6509433962264">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.6509433962264" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 5]"
          TopLeft="114.820754716981,125.5">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,32.1509433962264"
              Start="0,0"
              End="0,24.6509433962264">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.6509433962264" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 6]"
          TopLeft="114.820754716981,201.575471698113">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,32.1509433962264"
              Start="0,0"
              End="0,24.6509433962264">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.6509433962264" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 7]"
          TopLeft="114.820754716981,277.650943396226">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,32.1509433962264"
              Start="0,0"
              End="0,24.6509433962264">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,24.6509433962264" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
      </GraphLayout>
    </LayoutInfo>
  </Package>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>